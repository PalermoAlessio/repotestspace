{
  "version": 2,
  "description": "# Sistema di conversione numeri romani → arabi (v1.1)\n\nScopo: realizzare una libreria/utility che converta stringhe di numeri romani in interi decimali, con validazione rigorosa dell’input e messaggi di errore espliciti.\n\n---\n\n## Ambito\n- Input: stringa contenente un numero romano standard (alfabeto: I, V, X, L, C, D, M).\n- Output: intero decimale (base 10).\n- Dominio supportato: 1..3999 (notazione classica senza segni di moltiplicazione/overline).\n- Normalizzazione: consentita differenza maiuscole/minuscole; spazi iniziali/finali ignorati; nessun altro carattere consentito.\n\n## Definizioni\n- Simboli e valori: I=1, V=5, X=10, L=50, C=100, D=500, M=1000.\n- Coppie sottrattive valide: IV(4), IX(9), XL(40), XC(90), CD(400), CM(900).\n\n---\n\n## Requisiti funzionali\nF1. Convertire correttamente numeri romani validi in interi (1..3999).\nF2. Rifiutare stringhe non valide con un errore esplicativo.\nF3. Gestire input vuoti o solo spazi come non validi.\nF4. Consentire normalizzazione case-insensitive.\nF5. Esporre un’API pura (funzione) e, opzionalmente, una CLI.\n\n## Requisiti non funzionali\nN1. Complessità O(n) sulla lunghezza della stringa.\nN2. Zero dipendenze runtime non necessarie.\nN3. Copertura test ≥ 95% sui rami di validazione.\nN4. Messaggi d’errore deterministici e localizzabili.\n\n---\n\n## Regole di validazione (notazione classica)\n1) Ripetizioni: I, X, C, M ripetibili al massimo 3 volte consecutive (III, XXX, CCC, MMM). V, L, D non ripetibili.\n2) Sottrazione: consentita solo per le coppie valide (IV, IX, XL, XC, CD, CM).\n   - I può precedere solo V o X.\n   - X può precedere solo L o C.\n   - C può precedere solo D o M.\n3) Ordine: i simboli sono in ordine decrescente salvo le coppie sottrattive.\n4) Vietato: IL, IC, XM, VX, LC, DM, ripetizioni di 4 (es. IIII).\n5) Limite superiore: nessun numero > 3999 (niente notazioni con overline).\n\nRegex di validazione canonica (1..3999): `^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$`\n\n---\n\n## Interfacce\n### API (esempio)\n```ts\n// TypeScript/JS\n// Converte numero romano (1..3999). Lancia errore su input non valido.\nfunction romanToInt(input: string, opts?: { locale?: string }): number\n```\n\n### CLI (opzionale)\n```bash\nroman2int MCMXCIX\n# output: 1999\n\n# exit codes\n# 0: ok\n# 2: input non valido\n```\n\n---\n\n## Linee guida d’implementazione\nAlgoritmo (scansione sinistra→destra)\n1. Mappare ogni simbolo al suo valore.\n2. Leggere coppie: se valore corrente < valore successivo e la coppia è tra quelle ammesse, sommare (successivo - corrente) e saltare di 2; altrimenti sommare il valore corrente e avanzare di 1.\n3. Prima della conversione, validare l’intera stringa (regex o automa) per garantire conformità alle regole.\n4. Gestire normalizzazione (trim e uppercase) prima della validazione.\n\nAlternative: validazione tramite automa a stati / parser LL(1) per maggiore controllo su messaggi d’errore.\n\nComplessità: O(n) tempo, O(1) spazio.\n\n---\n\n## Esempi\n| Romano | Decimale | Note |\n|---|---:|---|\n| I | 1 | base |\n| IV | 4 | sottrattiva |\n| IX | 9 | sottrattiva |\n| XLII | 42 | mix |\n| XCIX | 99 | doppia sottrazione |\n| CD | 400 | sottrattiva |\n| CM | 900 | sottrattiva |\n| MCMXCIV | 1994 | classico |\n| MMMCMXCIX | 3999 | massimo |\n\n---\n\n## Casi limite e test minimi\n- Vuoto / solo spazi → errore.\n- Caratteri non ammessi (es. A, Z, _) → errore.\n- Ripetizioni eccessive: IIII, XXXX, CCCC, MMMM → errore.\n- Ripetizioni vietate: VV, LL, DD → errore.\n- Sottrazioni illegali: IL, IC, XD, XM, VX, LC, DM → errore.\n- Sequenze disordinate: IIV, XXC → errore.\n- Lowercase: mcmxciv → 1994.\n\nSuite di test consigliata: tabella di 50+ casi (validi/invalidi) con golden values.\n\n---\n\n## Errori ed eccezioni\n- InvalidRomanNumeralError con codice e messaggio localizzabile (es. code: `INVALID_SEQUENCE`, message con indicazione della coppia non valida).\n- Fornire posizione (indice) del primo errore quando possibile.\n\n---\n\n## Estensioni future (out of scope v1.1)\n- Supporto >3999 (notazione con overline o parentesi).\n- Conversione inversa (arabi → romani).\n- Modalità tollerante per numerali storicamente varianti.\n- i18n completa per messaggi CLI.\n\n---\n\n## Tracciabilità\n- F1 → test: conversione casi base/sottrattivi/massimo.\n- F2/F3 → test: input vuoti, caratteri invalidi, sequenze vietate.\n- F4 → test: lowercase/whitespace.\n- F5 → smoke test API e CLI.\n\nUltima modifica: 2025-11-05\n",
  "last_updated": "2025-11-05T19:05:40.865836Z",
  "iteration": 2
}